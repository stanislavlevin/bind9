From 0 Mon Sep 17 00:00:00 2001
From: "George V. Kouryachy (Fr. Br. George)" <george@altlinux.ru>
Date: Tue, 28 Jul 2015 17:40:56 +0300
Subject: [PATCH] bind-9.9.7 CVE-2015-5477 fix


diff --git a/bind/lib/dns/tkey.c b/bind/lib/dns/tkey.c
index defaced..defaced 100644
--- a/bind/lib/dns/tkey.c
+++ b/bind/lib/dns/tkey.c
@@ -650,6 +650,7 @@ dns_tkey_processquery(dns_message_t *msg, dns_tkeyctx_t *tctx,
 		 * Try the answer section, since that's where Win2000
 		 * puts it.
 		 */
+	  	name = NULL;
 		if (dns_message_findname(msg, DNS_SECTION_ANSWER, qname,
 					 dns_rdatatype_tkey, 0, &name,
 					 &tkeyset) != ISC_R_SUCCESS) {
